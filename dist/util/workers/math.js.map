{"version":3,"sources":["../../../src/util/workers/math.ts"],"sourcesContent":["import type { UnitDefinition } from \"mathjs\";\r\nimport { all, create } from \"mathjs\";\r\nimport { worker } from \"workerpool\";\r\nimport CustomClient from \"../CustomClient\";\r\n\r\nconst mathNumber = create(all, {\r\n\tnumber: \"BigNumber\",\r\n});\r\nconst mathFraction = create(all, {\r\n\tnumber: \"Fraction\",\r\n});\r\nconst units: Record<string, UnitDefinition> = {\r\n\tknot: {\r\n\t\tdefinition: \"0.514444444 m/s\",\r\n\t\taliases: [\"knot\", \"knots\", \"kt\", \"kts\", \"kn\"],\r\n\t},\r\n\tmph: {\r\n\t\tdefinition: \"0.44704 m/s\",\r\n\t\taliases: [\"miles per hour\", \"mph\", \"mile per hour\", \"MPH\", \"mi/h\"],\r\n\t},\r\n};\r\nconst evaluate = (expr: string, fraction: boolean) => {\r\n\tconst math = fraction ? mathFraction : mathNumber;\r\n\r\n\treturn math.format(math.evaluate(expr));\r\n};\r\n\r\nfor (const math of [mathNumber, mathFraction]) {\r\n\tfor (const unit in units)\r\n\t\tif (Object.hasOwn(units, unit)) math.createUnit(unit, units[unit]);\r\n\tmath.import(\r\n\t\t{\r\n\t\t\trange: () => {\r\n\t\t\t\tthrow new Error(\r\n\t\t\t\t\t\"La funzione `range` è disattivata per motivi di sicurezza\"\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t\timport: () => {\r\n\t\t\t\tthrow new Error(\r\n\t\t\t\t\t\"La funzione `import` è disattivata per motivi di sicurezza. Puoi suggerire nuove funzioni in <#816768278675849318>\"\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t\tcreateUnit: (message: unknown) => {\r\n\t\t\t\tCustomClient.printToStdout(\"Suggested new unit:\");\r\n\t\t\t\tCustomClient.printToStdout(message);\r\n\t\t\t\tthrow new Error(\r\n\t\t\t\t\t\"La funzione `createUnit` è disattivata per motivi di sicurezza. Suggerisci unità di misura mancanti in <#816768278675849318>\"\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t\tsimplify: () => {\r\n\t\t\t\tthrow new Error(\r\n\t\t\t\t\t\"La funzione `simplify` è disattivata per motivi di sicurezza\"\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t\tderivative: () => {\r\n\t\t\t\tthrow new Error(\r\n\t\t\t\t\t\"La funzione `derivative` è disattivata per motivi di sicurezza\"\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t},\r\n\t\t{ override: true }\r\n\t);\r\n}\r\nworker({ evaluate });\r\n"],"mappings":"4CACA,yCACA,oCAGA,GAAM,GAAa,EAAO,EAAK,CAC9B,OAAQ,WACT,CAAC,EACK,EAAe,EAAO,EAAK,CAChC,OAAQ,UACT,CAAC,EACK,EAAwC,CAC7C,KAAM,CACL,WAAY,kBACZ,QAAS,CAAC,OAAQ,QAAS,KAAM,MAAO,IAAI,CAC7C,EACA,IAAK,CACJ,WAAY,cACZ,QAAS,CAAC,iBAAkB,MAAO,gBAAiB,MAAO,MAAM,CAClE,CACD,EACM,EAAW,CAAC,EAAc,IAAsB,CACrD,GAAM,GAAO,EAAW,EAAe,EAEvC,MAAO,GAAK,OAAO,EAAK,SAAS,CAAI,CAAC,CACvC,EAEA,OAAW,KAAQ,CAAC,EAAY,CAAY,EAAG,CAC9C,OAAW,KAAQ,GAClB,AAAI,OAAO,OAAO,EAAO,CAAI,GAAG,EAAK,WAAW,EAAM,EAAM,EAAK,EAClE,EAAK,OACJ,CACC,MAAO,IAAM,CACZ,KAAM,IAAI,OACT,8DACD,CACD,EACA,OAAQ,IAAM,CACb,KAAM,IAAI,OACT,uHACD,CACD,EACA,WAAY,AAAC,GAAqB,CACjC,QAAa,cAAc,qBAAqB,EAChD,EAAa,cAAc,CAAO,EAC5B,GAAI,OACT,oIACD,CACD,EACA,SAAU,IAAM,CACf,KAAM,IAAI,OACT,iEACD,CACD,EACA,WAAY,IAAM,CACjB,KAAM,IAAI,OACT,mEACD,CACD,CACD,EACA,CAAE,SAAU,EAAK,CAClB,CACD,CACA,EAAO,CAAE,UAAS,CAAC","names":[]}