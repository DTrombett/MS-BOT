import{a as v,c as f,e as g}from"../chunk-R2SJYMZV.js";import{d as y}from"../chunk-R24UT4ZV.js";import{ApplicationCommandOptionType as s,ApplicationCommandType as S,ButtonStyle as $,ComponentType as j,GuildPremiumTier as h}from"discord-api-types/v10";import{escapeMarkdown as A}from"discord.js";var w={[h.None]:50,[h.Tier1]:100,[h.Tier2]:150,[h.Tier3]:250},T=v({data:[{type:S.ChatInput,name:"emoji",description:"Gestisci le emoji del server",options:[{type:s.Subcommand,name:"add",description:"Aggiungi un emoji",options:[{type:s.Attachment,name:"emoji",description:"L'emoji da aggiungere",required:!0},{type:s.String,name:"name",description:"Il nome dell'emoji"},{type:s.String,name:"roles",description:"Lista di ruoli che possono usare l'emoji",autocomplete:!0},{type:s.String,name:"reason",description:"La motivazione per l'aggiunta, se presente"}]},{type:s.Subcommand,name:"remove",description:"Rimuovi un emoji",options:[{type:s.String,name:"emoji",description:"L'emoji da rimuovere",required:!0,autocomplete:!0},{type:s.String,name:"reason",description:"La motivazione per la rimozione, se presente"}]},{type:s.Subcommand,name:"edit",description:"Modifica un emoji",options:[{type:s.String,name:"emoji",description:"L'emoji da modificare",required:!0,autocomplete:!0},{type:s.String,name:"name",description:"Il nuovo nome dell'emoji"},{type:s.String,name:"roles",description:"Lista di ruoli che possono usare l'emoji",autocomplete:!0},{type:s.String,name:"reason",description:"La motivazione per la modifica, se presente"}]},{type:s.Subcommand,name:"info",description:"Mostra le informazioni di un emoji",options:[{type:s.String,name:"emoji",description:"L'emoji da cercare",required:!0,autocomplete:!0}]},{type:s.Subcommand,name:"list",description:"Mostra la lista di emoji",options:[{type:s.Integer,name:"page",description:"La pagina da mostrare",min_value:1,max_value:10,required:!1}]}]}],async run(e){if(!e.inCachedGuild()){await e.reply({content:"Questo comando pu\xF2 essere solo usato in un server!",ephemeral:!0});return}let[{options:p,name:c}]=e.options.data;if(!p){await e.reply({content:"Questo comando non \xE8 attualmente disponibile!",ephemeral:!0});return}let{guild:m}=e;if(c==="add"){if(e.user.id!==m.ownerId&&!e.memberPermissions.has("ManageEmojisAndStickers")){await e.reply({content:"Hai bisogno del permesso **Gestire emoji e adesivi**",ephemeral:!0});return}let o,i,d,r;for(let n of p)n.name==="emoji"?o=n.attachment:n.name==="name"?i=typeof n.value=="string"?n.value:void 0:n.name==="roles"?r=(typeof n.value=="string"?n.value:void 0)?.split(/\s*,\s*/).map(a=>(a=a.toLowerCase(),/^\d{17,20}$/.test(a)?a:/^<@&\d{17,20}>$/.test(a)?a.slice(3,-1):m.roles.cache.find(u=>u.name.toLowerCase().startsWith(a))?.id)).filter(a=>a!==void 0):n.name==="reason"&&(d=typeof n.value=="string"?n.value:void 0);if(!o||!["image/png","image/jpeg","image/jpg","image/gif"].includes(o.contentType)){await e.reply({content:"Emoji non valida!",ephemeral:!0});return}if(i||=o.name?.split(".")[0],!i){await e.reply({content:"Non hai specificato un nome per l'emoji e l'immagine non ha un nome valido!",ephemeral:!0});return}if(i.length<2||i.length>32){await e.reply({content:"Il nome dell'emoji deve essere compreso tra 2 e 32 caratteri!",ephemeral:!0});return}if(!/^[a-zA-Z0-9-_]+$/.test(i)){await e.reply({content:"Il nome dell'emoji contiene caratteri non validi!",ephemeral:!0});return}if(o.size>=256*1024){await e.reply({content:"L'emoji deve essere pi\xF9 piccola di 256kb!",ephemeral:!0});return}if(m.emojis.cache.size>=w[m.premiumTier]){await e.reply({content:`Hai raggiunto il limite di emoji per questo server! (${w[m.premiumTier]})!`,ephemeral:!0});return}if(e.appPermissions?.has("ManageEmojisAndStickers")!==!0){await e.reply({content:"Ho bisogno del permesso **Gestire emoji e adesivi**!",ephemeral:!0});return}let[t]=await Promise.all([m.emojis.create({attachment:o.url,name:i,reason:d||void 0,roles:r}).catch(f),e.deferReply().catch(y.printToStderr)]);if(t instanceof Error){await g(e,t);return}let l=Math.round(t.createdTimestamp/1e3);await e.editReply({content:`${t.toString()} Emoji [${t.name}](${t.url}) (${t.id}) aggiunta con successo!

Animata: **${t.animated??!1?"S\xEC":"No"}**
Creata <t:${l}:F> (<t:${l}:R>)${r&&r.length>0?`
Ruoli consentiti: ${r.map(n=>`<@&${n}>`).join(", ")}`:""}`,components:[{type:j.ActionRow,components:[{type:j.Button,custom_id:`emoji-${t.id}-r`,style:$.Danger,label:"Rimuovi"}]}]});return}if(c==="remove"){if(e.user.id!==m.ownerId&&!e.memberPermissions.has("ManageEmojisAndStickers")){await e.reply({content:"Hai bisogno del permesso **Gestire emoji e adesivi**",ephemeral:!0});return}let o,i;for(let r of p)if(r.name==="emoji"){if(typeof r.value!="string")continue;let t=r.value.trim().toLowerCase();o=/^\d{17,20}$/.test(t)?t:/^<a?:[a-zA-Z0-9-_]+:\d{17,20}>$/.test(t)?t.replace(/^<:[a-zA-Z0-9-_]+:/,"").replace(/>$/,""):m.emojis.cache.find(l=>l.deletable&&l.name?.toLowerCase()===t)?.id}else r.name==="reason"&&(i=typeof r.value=="string"?r.value:void 0);if(!o){await e.reply({content:"Non hai specificato un'emoji valida!",ephemeral:!0});return}if(e.appPermissions?.has("ManageEmojisAndStickers")!==!0){await e.reply({content:"Ho bisogno del permesso **Gestire emoji e adesivi**!",ephemeral:!0});return}let d=await m.emojis.delete(o,i||void 0).catch(f);if(d instanceof Error){await g(e,d);return}await e.reply({content:"Emoji rimossa con successo!"})}if(c==="edit"){if(e.user.id!==m.ownerId&&!e.memberPermissions.has("ManageEmojisAndStickers")){await e.reply({content:"Hai bisogno del permesso **Gestire emoji e adesivi**",ephemeral:!0});return}let o,i,d,r;for(let n of p)if(n.name==="emoji"){if(typeof n.value!="string")continue;let a=n.value.trim().toLowerCase();o=/^\d{17,20}$/.test(a)?a:/^<a?:[a-zA-Z0-9-_]+:\d{17,20}>$/.test(a)?a.replace(/^<:[a-zA-Z0-9-_]+:/,"").replace(/>$/,""):m.emojis.cache.find(u=>u.deletable&&u.name?.toLowerCase()===a)?.id}else n.name==="name"?i=typeof n.value=="string"?n.value:void 0:n.name==="roles"?r=(typeof n.value=="string"?n.value:void 0)?.split(/\s*,\s*/).map(a=>(a=a.toLowerCase(),/^\d{17,20}$/.test(a)?a:/^<@&\d{17,20}>$/.test(a)?a.slice(3,-1):m.roles.cache.find(u=>u.name.toLowerCase().startsWith(a))?.id)).filter(a=>a!==void 0):n.name==="reason"&&(d=typeof n.value=="string"?n.value:void 0);if(!o){await e.reply({content:"Non hai specificato un'emoji valida!",ephemeral:!0});return}if(i){if(i.length<2||i.length>32){await e.reply({content:"Il nome dell'emoji deve essere compreso tra 2 e 32 caratteri!",ephemeral:!0});return}if(!/^[a-zA-Z0-9-_]+$/.test(i)){await e.reply({content:"Il nome dell'emoji contiene caratteri non validi!",ephemeral:!0});return}}if(e.appPermissions?.has("ManageEmojisAndStickers")!==!0){await e.reply({content:"Ho bisogno del permesso **Gestire emoji e adesivi**!",ephemeral:!0});return}let t=await m.emojis.edit(o,{name:i,reason:d||void 0,roles:r}).catch(f);if(t instanceof Error){await g(e,t);return}let l=Math.round(t.createdTimestamp/1e3);await e.reply({content:`${t.toString()} Emoji [${t.name}](${t.url}) (${t.id}) modificata con successo!

Animata: **${t.animated??!1?"S\xEC":"No"}**
Creata <t:${l}:F> (<t:${l}:R>)${r&&r.length>0?`
Ruoli consentiti: ${r.map(n=>`<@&${n}>`).join(", ")}`:""}`,components:[{type:j.ActionRow,components:[{type:j.Button,custom_id:`emoji-${t.id}-r`,style:$.Danger,label:"Rimuovi"}]}]});return}if(c==="info"){let o=p.find(t=>t.name==="emoji")?.value;if(typeof o!="string"){await e.reply({content:"Non hai specificato un'emoji valida!",ephemeral:!0});return}o=o.trim().toLowerCase();let i=await(/^\d{17,20}$/.test(o)?m.emojis.fetch(o):/^<a?:[a-zA-Z0-9-_]+:\d{17,20}>$/.test(o)?m.emojis.fetch(o.replace(/^<:[a-zA-Z0-9-_]+:/,"").replace(/>$/,"")):m.emojis.cache.find(t=>t.name?.toLowerCase()===o));if(!i){await e.reply({content:"Non hai specificato un'emoji valida!",ephemeral:!0});return}let d=Math.round(i.createdTimestamp/1e3),{roles:r}=i;await e.reply({content:`${i.toString()} [${i.name??"emoji"}](${i.url}) (${i.id})

Animata: **${i.animated??!1?"S\xEC":"No"}**
Creata <t:${d}:F> (<t:${d}:R>)
Gestita da un integrazione: **${i.managed===!0?"S\xEC":"No"}**${i.author?`
Autore: <@${i.author.id}> (**${A(i.author.tag)}**)`:""}${r.cache.size>0?`
Ruoli consentiti: ${r.cache.map(t=>`<@&${t.id}>`).join(", ")}`:""}`})}},async component(e){if(!e.inCachedGuild()){await e.reply({content:"Questo comando pu\xF2 essere solo usato in un server!",ephemeral:!0});return}}});export{T as command};
//# sourceMappingURL=emojis.js.map