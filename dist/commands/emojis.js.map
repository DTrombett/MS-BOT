{"version":3,"sources":["../../src/commands/emojis.ts"],"sourcesContent":["import { SlashCommandBuilder } from \"@discordjs/builders\";\r\nimport type { Snowflake } from \"discord-api-types/v10\";\r\nimport type {\r\n\tApplicationCommandOptionChoiceData,\r\n\tInteractionReplyOptions,\r\n\tWebhookEditMessageOptions,\r\n} from \"discord.js\";\r\nimport type { CommandOptions } from \"../util\";\r\nimport {\r\n\tcreateEmoji,\r\n\tdeleteEmoji,\r\n\teditEmoji,\r\n\temojiInfo,\r\n\temojiList,\r\n} from \"../util\";\r\n\r\nenum SubCommands {\r\n\tlist = \"list\",\r\n\tinfo = \"info\",\r\n\tcreate = \"create\",\r\n\tdelete = \"delete\",\r\n\tedit = \"edit\",\r\n}\r\nenum Options {\r\n\temoji = \"emoji\",\r\n\tpage = \"page\",\r\n\tfile = \"file\",\r\n\tname = \"name\",\r\n\treason = \"reason\",\r\n\trole = \"role\",\r\n}\r\n\r\nexport const command: CommandOptions = {\r\n\tdata: new SlashCommandBuilder()\r\n\t\t.setName(\"emojis\")\r\n\t\t.setDescription(\"Gestisci le emoji del server\")\r\n\t\t.addSubcommand((list) =>\r\n\t\t\tlist\r\n\t\t\t\t.setName(SubCommands.list)\r\n\t\t\t\t.setDescription(\"Mostra tutte le emoji del server\")\r\n\t\t\t\t.addIntegerOption((page) =>\r\n\t\t\t\t\tpage\r\n\t\t\t\t\t\t.setName(Options.page)\r\n\t\t\t\t\t\t.setDescription(\r\n\t\t\t\t\t\t\t\"Pagina da mostrare - Ogni pagina contiene 25 emoji\"\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t\t.setMaxValue(10)\r\n\t\t\t\t)\r\n\t\t)\r\n\t\t.addSubcommand((info) =>\r\n\t\t\tinfo\r\n\t\t\t\t.setName(SubCommands.info)\r\n\t\t\t\t.setDescription(\"Mostra le informazioni di un emoji\")\r\n\t\t\t\t.addStringOption((emoji) =>\r\n\t\t\t\t\temoji\r\n\t\t\t\t\t\t.setName(Options.emoji)\r\n\t\t\t\t\t\t.setDescription(\"L'emoji da cercare\")\r\n\t\t\t\t\t\t.setAutocomplete(true)\r\n\t\t\t\t\t\t.setRequired(true)\r\n\t\t\t\t)\r\n\t\t)\r\n\t\t.addSubcommand((create) =>\r\n\t\t\tcreate\r\n\t\t\t\t.setName(SubCommands.create)\r\n\t\t\t\t.setDescription(\"Carica un emoji\")\r\n\t\t\t\t.addAttachmentOption((file) =>\r\n\t\t\t\t\tfile\r\n\t\t\t\t\t\t.setName(Options.file)\r\n\t\t\t\t\t\t.setDescription(\r\n\t\t\t\t\t\t\t\"L'immagine da caricare. Tipo: .png, .jpg, .gif, .webp. Dimensione max: 256kb\"\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t\t.setRequired(true)\r\n\t\t\t\t)\r\n\t\t\t\t.addStringOption((name) =>\r\n\t\t\t\t\tname\r\n\t\t\t\t\t\t.setName(Options.name)\r\n\t\t\t\t\t\t.setDescription(\r\n\t\t\t\t\t\t\t\"Il nome dell'emoji, lungo almeno 2 caratteri e con solo caratteri alfanumerici e trattini bassi\"\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t\t.setRequired(true)\r\n\t\t\t\t)\r\n\t\t\t\t.addStringOption((reason) =>\r\n\t\t\t\t\treason\r\n\t\t\t\t\t\t.setName(Options.reason)\r\n\t\t\t\t\t\t.setDescription(\"Il motivo per cui stai caricando l'emoji\")\r\n\t\t\t\t)\r\n\t\t\t\t.addRoleOption((role) =>\r\n\t\t\t\t\trole\r\n\t\t\t\t\t\t.setName(Options.role)\r\n\t\t\t\t\t\t.setDescription(\"Il ruolo che può utilizzare questa emoji\")\r\n\t\t\t\t)\r\n\t\t)\r\n\t\t.addSubcommand((del) =>\r\n\t\t\tdel\r\n\t\t\t\t.setName(SubCommands.delete)\r\n\t\t\t\t.setDescription(\"Elimina un emoji\")\r\n\t\t\t\t.addStringOption((emoji) =>\r\n\t\t\t\t\temoji\r\n\t\t\t\t\t\t.setName(Options.emoji)\r\n\t\t\t\t\t\t.setDescription(\"L'emoji da eliminare\")\r\n\t\t\t\t\t\t.setAutocomplete(true)\r\n\t\t\t\t\t\t.setRequired(true)\r\n\t\t\t\t)\r\n\t\t\t\t.addStringOption((reason) =>\r\n\t\t\t\t\treason\r\n\t\t\t\t\t\t.setName(Options.reason)\r\n\t\t\t\t\t\t.setDescription(\"Il motivo per cui stai eliminando l'emoji\")\r\n\t\t\t\t)\r\n\t\t)\r\n\t\t.addSubcommand((edit) =>\r\n\t\t\tedit\r\n\t\t\t\t.setName(SubCommands.edit)\r\n\t\t\t\t.setDescription(\"Modifica un emoji\")\r\n\t\t\t\t.addStringOption((emoji) =>\r\n\t\t\t\t\temoji\r\n\t\t\t\t\t\t.setName(Options.emoji)\r\n\t\t\t\t\t\t.setDescription(\"L'emoji da modificare\")\r\n\t\t\t\t\t\t.setAutocomplete(true)\r\n\t\t\t\t\t\t.setRequired(true)\r\n\t\t\t\t)\r\n\t\t\t\t.addStringOption((name) =>\r\n\t\t\t\t\tname.setName(Options.name).setDescription(\"Il nuovo nome dell'emoji\")\r\n\t\t\t\t)\r\n\t\t\t\t.addRoleOption((role) =>\r\n\t\t\t\t\trole\r\n\t\t\t\t\t\t.setName(Options.role)\r\n\t\t\t\t\t\t.setDescription(\"Il ruolo che può utilizzare questa emoji\")\r\n\t\t\t\t)\r\n\t\t\t\t.addStringOption((reason) =>\r\n\t\t\t\t\treason\r\n\t\t\t\t\t\t.setName(Options.reason)\r\n\t\t\t\t\t\t.setDescription(\"Il motivo per cui stai modificando l'emoji\")\r\n\t\t\t\t)\r\n\t\t),\r\n\tisPublic: true,\r\n\tasync run(interaction) {\r\n\t\tlet options: InteractionReplyOptions & WebhookEditMessageOptions;\r\n\r\n\t\tswitch (interaction.options.getSubcommand()) {\r\n\t\t\tcase SubCommands.list:\r\n\t\t\t\tif (!interaction.inCachedGuild()) {\r\n\t\t\t\t\tawait interaction.reply({\r\n\t\t\t\t\t\tcontent:\r\n\t\t\t\t\t\t\t\"Questo comando è disponibile solo all'interno dei server!\",\r\n\t\t\t\t\t\tephemeral: true,\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tconst page = interaction.options.getInteger(Options.page);\r\n\r\n\t\t\t\toptions = await emojiList(\r\n\t\t\t\t\tthis.client,\r\n\t\t\t\t\tinteraction.guildId,\r\n\t\t\t\t\tpage != null ? `${page - 1}` : undefined\r\n\t\t\t\t);\r\n\r\n\t\t\t\tawait interaction.reply(options);\r\n\t\t\t\tbreak;\r\n\t\t\tcase SubCommands.info:\r\n\t\t\t\toptions = await emojiInfo(\r\n\t\t\t\t\tthis.client,\r\n\t\t\t\t\tinteraction.options.getString(Options.emoji, true),\r\n\t\t\t\t\tinteraction.guildId ?? undefined\r\n\t\t\t\t);\r\n\r\n\t\t\t\tawait interaction.reply(options);\r\n\t\t\t\tbreak;\r\n\t\t\tcase SubCommands.create:\r\n\t\t\t\tif (!interaction.inCachedGuild()) {\r\n\t\t\t\t\tawait interaction.reply({\r\n\t\t\t\t\t\tcontent:\r\n\t\t\t\t\t\t\t\"Questo comando è disponibile solo all'interno dei server!\",\r\n\t\t\t\t\t\tephemeral: true,\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t[options] = await Promise.all([\r\n\t\t\t\t\tcreateEmoji(\r\n\t\t\t\t\t\tthis.client,\r\n\t\t\t\t\t\tinteraction.guildId,\r\n\t\t\t\t\t\tinteraction.options.getAttachment(Options.file, true).proxyURL,\r\n\t\t\t\t\t\tinteraction.options.getString(Options.name, true),\r\n\t\t\t\t\t\tinteraction.user.id,\r\n\t\t\t\t\t\tinteraction.options.getString(Options.reason) ?? undefined,\r\n\t\t\t\t\t\t...[interaction.options.getRole(Options.role)?.id].filter(\r\n\t\t\t\t\t\t\t(id): id is Snowflake => id != null\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t),\r\n\t\t\t\t\tinteraction.deferReply(),\r\n\t\t\t\t]);\r\n\r\n\t\t\t\tawait interaction.editReply(options);\r\n\t\t\t\tbreak;\r\n\t\t\tcase SubCommands.delete:\r\n\t\t\t\tif (!interaction.inCachedGuild()) {\r\n\t\t\t\t\tawait interaction.reply({\r\n\t\t\t\t\t\tcontent:\r\n\t\t\t\t\t\t\t\"Questo comando è disponibile solo all'interno dei server!\",\r\n\t\t\t\t\t\tephemeral: true,\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t[options] = await Promise.all([\r\n\t\t\t\t\tdeleteEmoji(\r\n\t\t\t\t\t\tthis.client,\r\n\t\t\t\t\t\tinteraction.options.getString(Options.emoji, true),\r\n\t\t\t\t\t\tinteraction.guildId,\r\n\t\t\t\t\t\tinteraction.user.id,\r\n\t\t\t\t\t\tinteraction.options.getString(Options.reason) ?? undefined\r\n\t\t\t\t\t),\r\n\t\t\t\t\tinteraction.deferReply(),\r\n\t\t\t\t]);\r\n\r\n\t\t\t\tawait interaction.editReply(options);\r\n\t\t\t\tbreak;\r\n\t\t\tcase SubCommands.edit:\r\n\t\t\t\tif (!interaction.inCachedGuild()) {\r\n\t\t\t\t\tawait interaction.reply({\r\n\t\t\t\t\t\tcontent:\r\n\t\t\t\t\t\t\t\"Questo comando è disponibile solo all'interno dei server!\",\r\n\t\t\t\t\t\tephemeral: true,\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t[options] = await Promise.all([\r\n\t\t\t\t\teditEmoji(\r\n\t\t\t\t\t\tthis.client,\r\n\t\t\t\t\t\tinteraction.options.getString(Options.emoji, true),\r\n\t\t\t\t\t\tinteraction.guildId,\r\n\t\t\t\t\t\tinteraction.options.getString(Options.name) ?? undefined,\r\n\t\t\t\t\t\tinteraction.user.id,\r\n\t\t\t\t\t\tinteraction.options.getString(Options.reason) ?? undefined,\r\n\t\t\t\t\t\t...[interaction.options.getRole(Options.role)?.id].filter(\r\n\t\t\t\t\t\t\t(id): id is Snowflake => id != null\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t),\r\n\t\t\t\t\tinteraction.deferReply(),\r\n\t\t\t\t]);\r\n\r\n\t\t\t\tawait interaction.editReply(options);\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tawait interaction.reply(\"Comando non riconosciuto.\");\r\n\t\t}\r\n\t},\r\n\tasync autocomplete(interaction) {\r\n\t\tconst option = interaction.options.getFocused(\r\n\t\t\ttrue\r\n\t\t) as ApplicationCommandOptionChoiceData & { name: Options };\r\n\r\n\t\tswitch (option.name) {\r\n\t\t\tcase Options.emoji:\r\n\t\t\t\toption.value = option.value.toString().toLowerCase();\r\n\t\t\t\tconst emojis = interaction.guild?.emojis.cache.filter(\r\n\t\t\t\t\t(emoji) =>\r\n\t\t\t\t\t\temoji.name != null &&\r\n\t\t\t\t\t\t(emoji.name.toLowerCase().includes(option.value as string) ||\r\n\t\t\t\t\t\t\temoji.id.includes(option.value as string))\r\n\t\t\t\t);\r\n\r\n\t\t\t\tif (!emojis || emojis.size <= 0) return interaction.respond([]);\r\n\t\t\t\tawait interaction.respond(\r\n\t\t\t\t\temojis.first(25).map((emoji) => ({\r\n\t\t\t\t\t\tname: `${emoji.name!} (${emoji.id})`,\r\n\t\t\t\t\t\tvalue: emoji.id,\r\n\t\t\t\t\t}))\r\n\t\t\t\t);\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\treturn interaction.respond([]);\r\n\t\t}\r\n\t\treturn undefined;\r\n\t},\r\n};\r\n"],"mappings":"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","names":[]}