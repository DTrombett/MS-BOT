import{a as u,c as m,d as c,f as d}from"../chunk-QQX4XUVK.js";import"../chunk-NJIM6YGF.js";import{ApplicationCommandOptionType as l,ApplicationCommandType as w,ButtonStyle as y,ChannelType as g,ComponentType as p,VideoQualityMode as C}from"discord-api-types/v10";import s from"ms";var h=async a=>a.memberPermissions.has("ManageChannels")?!1:(await a.reply({content:"Non hai i permessi necessari per usare questo comando!",ephemeral:!0}),!0),v=async(a,n)=>n.channel&&"setRateLimitPerUser"in n.channel?n.channel.manageable?isNaN(n.rateLimitPerUser)?(await a.reply({content:"Hai inserito un valore non valido per la slowmode!",ephemeral:!0}),!0):n.rateLimitPerUser<0||n.rateLimitPerUser>21600?(await a.reply({content:"La durata della slowmode deve essere compresa tra 0 secondi e 6 ore!",ephemeral:!0}),!0):n.rateLimitPerUser===n.channel.rateLimitPerUser?(await a.reply({content:"La slowmode \xE8 gi\xE0 impostata a questo valore!",ephemeral:!0}),!0):!1:(await a.reply({content:"Non ho i permessi necessari per gestire il canale selezionato!",ephemeral:!0}),!0):(await a.reply({content:"Questa azione non pu\xF2 essere eseguita nel canale selezionato!",ephemeral:!0}),!0),f=async(a,n)=>{let e=n.channel.rateLimitPerUser,t=await n.channel.setRateLimitPerUser(n.rateLimitPerUser,n.reason).catch(c);if(t instanceof Error){await d(a,t);return}await a.reply({content:`Slowmode ${n.rateLimitPerUser?`impostata a **${s(n.rateLimitPerUser*1e3)}**`:"disattivata"} in <#${n.channel.id}> con successo!`,components:[{type:p.ActionRow,components:[{type:p.Button,custom_id:`channel-s-${n.channel.id}-${n.rateLimitPerUser||e==null?0:e}`,label:n.rateLimitPerUser||e==null?"Rimuovi":"Annulla",style:y.Danger}]}]})},S=u({data:[{name:"channel",description:"Gestisci i canali",type:w.ChatInput,options:[{type:l.Subcommand,name:"slowmode",description:"Imposta o mostra la slowmode",options:[{name:"duration",description:"La nuova slowmode (0 per disattivarla, vuoto per mostrare quella attuale)",type:l.String},{name:"reason",description:"Il motivo della modifica della slowmode",type:l.String,max_length:512},{name:"channel",description:"Il canale da gestire (default: questo canale)",type:l.Channel}]},{type:l.Subcommand,name:"info",description:"Mostra le informazioni sul canale",options:[{name:"channel",description:"Il canale da mostrare (default: questo canale)",type:l.Channel}]}]}],async run(a){if(!a.inCachedGuild()){await a.reply({content:"Questo comando pu\xF2 essere usato solo all'interno di un server!",ephemeral:!0});return}let[{options:n}]=a.options.data;if(!n){await a.reply({content:"Questo comando non \xE8 attualmente disponibile!",ephemeral:!0});return}if(a.options.data[0].name==="slowmode"){if(n.some(o=>o.name==="duration")){if(await h(a))return;let o={channel:a.channel,rateLimitPerUser:0};for(let r of n)r.name==="channel"&&r.channel&&"client"in r.channel?o.channel=r.channel:r.name==="duration"?o.rateLimitPerUser=s(typeof r.value=="string"?r.value:"")||0:r.name==="reason"&&typeof r.value=="string"&&(o.reason=r.value);if(o.rateLimitPerUser=Math.round(o.rateLimitPerUser/1e3),await v(a,o))return;await f(a,o);return}let e=a.options.getChannel("channel"),t=e&&"setRateLimitPerUser"in e?e:a.channel;if(!t){await a.reply({content:"Canale non valido!",ephemeral:!0});return}await a.reply({content:t.rateLimitPerUser??0?`Slowmode attiva in <#${t.id}> ogni **${s(t.rateLimitPerUser*1e3)}**.`:`Slowmode non attiva in <#${t.id}>.`});return}if(a.options.data[0].name==="info"){let e=a.options.getChannel("channel")??a.channel;if(!(e&&"client"in e)){await a.reply({content:"Canale non valido!",ephemeral:!0});return}let t=e.createdTimestamp!=null?Math.round(e.createdTimestamp/1e3):0,o="lastPinTimestamp"in e&&e.lastPinTimestamp!=null?Math.round(e.lastPinTimestamp/1e3):0,r="archiveTimestamp"in e&&e.archiveTimestamp!=null?Math.round(e.archiveTimestamp/1e3):0,i=[{name:"ID",value:e.id,inline:!0},{name:"Tipo",value:g[e.type],inline:!0},{name:"NSFW",value:"nsfw"in e&&e.nsfw?"S\xEC":"No",inline:!0},{name:"Slowmode",value:"rateLimitPerUser"in e&&e.rateLimitPerUser?s(e.rateLimitPerUser*1e3):"Non attiva",inline:!0},{name:"Ultimo messaggio attaccato",value:o?`<t:${o}:F> (<t:${o}:R>)`:"*Nessun messaggio attaccato*",inline:!0},{name:"Creato",value:t?`<t:${t}:F> (<t:${t}:R>)`:"Non disponibile",inline:!0}];"position"in e&&i.push({name:"Posizione",value:`${e.position}`,inline:!0}),"bitrate"in e&&i.push({name:"Bitrate",value:`${m(e.bitrate)}/s`,inline:!0}),"userLimit"in e&&i.push({name:"Limite utenti",value:`${e.userLimit}`,inline:!0}),"parentId"in e&&e.parentId!=null&&i.push({name:"Categoria",value:`<#${e.parentId}>`,inline:!0}),"rtcRegion"in e&&i.push({name:"Regione",value:e.rtcRegion??"Automatica",inline:!0}),"videoQualityMode"in e&&i.push({name:"Qualit\xE0 video",value:e.videoQualityMode===C.Full?"720p":"Auto",inline:!0}),"messageCount"in e&&e.messageCount!=null&&i.push({name:"Messaggi",value:`${e.messageCount>=50?"50+":e.messageCount}`,inline:!0}),"memberCount"in e&&e.memberCount!=null&&i.push({name:"Membri",value:`${e.memberCount>=50?"50+":e.memberCount}`,inline:!0}),"defaultAutoArchiveDuration"in e&&i.push({name:"Durata di autoarchiviazione dei thread predefinita",value:e.defaultAutoArchiveDuration==null?"Non presente":s(e.defaultAutoArchiveDuration*60*1e3),inline:!0}),"archived"in e&&i.push({name:"Archiviato",value:e.archived?"S\xEC":"No",inline:!0}),"autoArchiveDuration"in e&&i.push({name:"Autoarchiviazione dopo",value:e.autoArchiveDuration==null?"Non attiva":s(e.autoArchiveDuration*60*1e3),inline:!0}),r&&i.push({name:"archived"in e?e.archived?"Archiviato":"Aperto":"Archiviato/Aperto",value:`<t:${r}:F> (<t:${r}:R>)`,inline:!0}),"locked"in e&&i.push({name:"Bloccato",value:e.locked?"S\xEC":"No",inline:!0}),"invitable"in e&&e.invitable!=null&&i.push({name:"Si pu\xF2 invitare",value:e.invitable?"S\xEC":"No",inline:!0}),await a.reply({embeds:[{url:e.url,title:`#${e.name}`,author:{name:e.guild.name,icon_url:e.guild.iconURL({extension:"png",size:4096})??void 0,url:`https://discord.com/channels/${e.guildId}`},color:a.member.roles.highest.color,description:"topic"in e&&e.topic?`> ${e.topic}`:void 0,footer:{text:"Ultimo aggiornamento"},timestamp:new Date().toISOString(),fields:i.slice(0,25)}]})}},async component(a){if(!a.inCachedGuild()){await a.reply({content:"Questo comando pu\xF2 essere usato solo all'interno di un server!",ephemeral:!0});return}let[,n,...e]=a.customId.split("-");if(!n||!["s"].includes(n)){await a.reply({content:"Azione non valida!",ephemeral:!0});return}if(n==="s"){if(await h(a))return;let t={channel:a.guild.channels.cache.get(e[0])??a.channel,rateLimitPerUser:Number(e[1])||0};if(await v(a,t))return;await f(a,t)}}});export{S as command};
//# sourceMappingURL=channel.js.map