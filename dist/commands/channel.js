import{a as u,b as m,d as c,e as d,g as p}from"../chunk-HUHUXK6N.js";import"../chunk-NJIM6YGF.js";import{ApplicationCommandOptionType as l,ApplicationCommandType as y,ButtonStyle as g,ChannelType as C,ComponentType as h,VideoQualityMode as P}from"discord-api-types/v10";import s from"ms";var v=async n=>n.memberPermissions.has("ManageChannels")?!1:(await n.reply({content:"Non hai i permessi necessari per usare questo comando!",ephemeral:!0}),!0),f=async(n,a)=>a.channel&&"setRateLimitPerUser"in a.channel?a.channel.manageable?isNaN(a.rateLimitPerUser)?(await n.reply({content:"Hai inserito un valore non valido per lo slowmode!",ephemeral:!0}),!0):a.rateLimitPerUser<0||a.rateLimitPerUser>21600?(await n.reply({content:"La durata dello slowmode deve essere compresa tra 0 secondi e 6 ore!",ephemeral:!0}),!0):a.rateLimitPerUser===a.channel.rateLimitPerUser?(await n.reply({content:"Lo slowmode \xE8 gi\xE0 impostata a questo valore!",ephemeral:!0}),!0):!1:(await n.reply({content:"Non ho i permessi necessari per gestire il canale selezionato!",ephemeral:!0}),!0):(await n.reply({content:"Questa azione non pu\xF2 essere eseguita nel canale selezionato!",ephemeral:!0}),!0),w=async(n,a)=>{let e=a.channel.rateLimitPerUser,t=await a.channel.setRateLimitPerUser(a.rateLimitPerUser,a.reason).catch(d);if(t instanceof Error){await p(n,t);return}await n.reply({content:`Slowmode ${a.rateLimitPerUser?`impostato a **${s(a.rateLimitPerUser*1e3)}**`:"disattivato"} in <#${a.channel.id}> con successo!`,components:[{type:h.ActionRow,components:[{type:h.Button,custom_id:`channel-s-${a.channel.id}-${a.rateLimitPerUser||e==null?0:e}`,label:a.rateLimitPerUser||e==null?"Rimuovi":"Annulla",style:g.Danger}]}]})},b=m({data:[{name:"channel",description:"Gestisci i canali",type:y.ChatInput,options:[{type:l.Subcommand,name:"slowmode",description:"Imposta o mostra lo slowmode",options:[{name:"duration",description:"Il nuovo slowmode (0 per disattivarlo, vuoto per mostrare quella attuale)",type:l.String},{name:"reason",description:"Il motivo della modifica dello slowmode",type:l.String,max_length:512},{name:"channel",description:"Il canale da gestire (default: questo canale)",type:l.Channel}]},{type:l.Subcommand,name:"info",description:"Mostra le informazioni sul canale",options:[{name:"channel",description:"Il canale da mostrare (default: questo canale)",type:l.Channel}]}]}],async run(n){if(!n.inCachedGuild()){await n.reply({content:"Questo comando pu\xF2 essere usato solo all'interno di un server!",ephemeral:!0});return}let[{options:a}]=n.options.data;if(!a){await n.reply({content:"Questo comando non \xE8 attualmente disponibile!",ephemeral:!0});return}if(n.options.data[0].name==="slowmode"){if(a.some(o=>o.name==="duration")){if(await v(n))return;let o={channel:n.channel,rateLimitPerUser:0};for(let r of a)r.name==="channel"&&r.channel&&"client"in r.channel?o.channel=r.channel:r.name==="duration"?o.rateLimitPerUser=s(typeof r.value=="string"?r.value:"")||0:r.name==="reason"&&typeof r.value=="string"&&(o.reason=r.value);if(o.rateLimitPerUser=Math.round(o.rateLimitPerUser/1e3),await f(n,o))return;await w(n,o);return}let e=n.options.getChannel("channel"),t=e&&"setRateLimitPerUser"in e?e:n.channel;if(!t){await n.reply({content:"Canale non valido!",ephemeral:!0});return}await n.reply({content:t.rateLimitPerUser??0?`Slowmode attivo in <#${t.id}> ogni **${s(t.rateLimitPerUser*1e3)}**.`:`Slowmode non attivo in <#${t.id}>.`});return}if(n.options.data[0].name==="info"){let e=n.options.getChannel("channel")??n.channel;if(!(e&&"client"in e)){await n.reply({content:"Canale non valido!",ephemeral:!0});return}let t=e.createdTimestamp!=null?Math.round(e.createdTimestamp/1e3):0,o="lastPinTimestamp"in e&&e.lastPinTimestamp!=null?Math.round(e.lastPinTimestamp/1e3):0,r="archiveTimestamp"in e&&e.archiveTimestamp!=null?Math.round(e.archiveTimestamp/1e3):0,i=[{name:"ID",value:e.id,inline:!0},{name:"Tipo",value:C[e.type],inline:!0},{name:"NSFW",value:"nsfw"in e&&e.nsfw?"S\xEC":"No",inline:!0},{name:"Slowmode",value:"rateLimitPerUser"in e&&e.rateLimitPerUser?s(e.rateLimitPerUser*1e3):"*Non attivo*",inline:!0},{name:"Ultimo messaggio attaccato",value:o?`<t:${o}:F> (<t:${o}:R>)`:"*Nessun messaggio attaccato*",inline:!0},{name:"Creato",value:t?`<t:${t}:F> (<t:${t}:R>)`:"*Non disponibile*",inline:!0}];"position"in e&&i.push({name:"Posizione",value:`${e.position+1}`,inline:!0}),"bitrate"in e&&i.push({name:"Bitrate",value:`${c(e.bitrate,1e3,!1).toLowerCase()}ps`,inline:!0}),"userLimit"in e&&i.push({name:"Limite utenti",value:`${e.userLimit||"*Nessun limite*"}`,inline:!0}),"parentId"in e&&e.parentId!=null&&i.push({name:"Categoria",value:`<#${e.parentId}>`,inline:!0}),"rtcRegion"in e&&i.push({name:"Regione",value:u(e.rtcRegion??"*Automatica*"),inline:!0}),"videoQualityMode"in e&&i.push({name:"Qualit\xE0 video",value:e.videoQualityMode===P.Full?"720p":"Auto",inline:!0}),"messageCount"in e&&e.messageCount!=null&&i.push({name:"Messaggi",value:`${e.messageCount>=50?"50+":e.messageCount}`,inline:!0}),"memberCount"in e&&e.memberCount!=null&&i.push({name:"Membri",value:`${e.memberCount>=50?"50+":e.memberCount}`,inline:!0}),"defaultAutoArchiveDuration"in e&&i.push({name:"Durata di autoarchiviazione dei thread predefinita",value:e.defaultAutoArchiveDuration==null?"*Non attiva*":s(e.defaultAutoArchiveDuration*60*1e3),inline:!0}),"archived"in e&&i.push({name:"Archiviato",value:e.archived?"S\xEC":"No",inline:!0}),"autoArchiveDuration"in e&&i.push({name:"Autoarchiviazione dopo",value:e.autoArchiveDuration==null?"*Non attiva*":s(e.autoArchiveDuration*60*1e3),inline:!0}),r&&i.push({name:"archived"in e?e.archived?"Archiviato":"Aperto":"Archiviato/Aperto",value:`<t:${r}:F> (<t:${r}:R>)`,inline:!0}),"locked"in e&&i.push({name:"Bloccato",value:e.locked?"S\xEC":"No",inline:!0}),"invitable"in e&&e.invitable!=null&&i.push({name:"Si pu\xF2 invitare",value:e.invitable?"S\xEC":"No",inline:!0}),await n.reply({embeds:[{url:e.url,title:`#${e.name}`,author:{name:e.guild.name,icon_url:e.guild.iconURL({extension:"png",size:4096})??void 0,url:`https://discord.com/channels/${e.guildId}`},color:n.member.roles.color?.color,description:"topic"in e&&e.topic?`>>> ${e.topic}`:void 0,footer:{text:"Ultimo aggiornamento"},timestamp:new Date().toISOString(),fields:i.slice(0,25)}]})}},async component(n){if(!n.inCachedGuild()){await n.reply({content:"Questo comando pu\xF2 essere usato solo all'interno di un server!",ephemeral:!0});return}let[,a,...e]=n.customId.split("-");if(!a||!["s"].includes(a)){await n.reply({content:"Azione non valida!",ephemeral:!0});return}if(a==="s"){if(await v(n))return;let t={channel:n.guild.channels.cache.get(e[0])??n.channel,rateLimitPerUser:Number(e[1])||0};if(await f(n,t))return;await w(n,t)}}});export{b as command};
//# sourceMappingURL=channel.js.map