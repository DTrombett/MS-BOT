import{a as s,c as m,e as c}from"../chunk-ZBDK6ERH.js";import"../chunk-6RVUKQTV.js";import{ApplicationCommandOptionType as l,ApplicationCommandType as w,ButtonStyle as f,ComponentType as u}from"discord-api-types/v10";import i from"ms";var d=async e=>e.memberPermissions.has("ManageChannels")?!1:(await e.reply({content:"Non hai i permessi necessari per usare questo comando!",ephemeral:!0}),!0),p=async(e,a)=>a.channel&&"setRateLimitPerUser"in a.channel?a.channel.manageable?isNaN(a.rateLimitPerUser)?(await e.reply({content:"Hai inserito un valore non valido per la slowmode!",ephemeral:!0}),!0):a.rateLimitPerUser<0||a.rateLimitPerUser>21600?(await e.reply({content:"La durata della slowmode deve essere compresa tra 0 secondi e 6 ore!",ephemeral:!0}),!0):a.rateLimitPerUser===a.channel.rateLimitPerUser?(await e.reply({content:"La slowmode \xE8 gi\xE0 impostata a questo valore!",ephemeral:!0}),!0):!1:(await e.reply({content:"Non ho i permessi necessari per gestire il canale selezionato!",ephemeral:!0}),!0):(await e.reply({content:"Questa azione non pu\xF2 essere eseguita nel canale selezionato!",ephemeral:!0}),!0),h=async(e,a)=>{let t=a.channel.rateLimitPerUser,n=await a.channel.setRateLimitPerUser(a.rateLimitPerUser,a.reason).catch(m);if(n instanceof Error){await c(e,n);return}await e.reply({content:`Slowmode ${a.rateLimitPerUser?`impostata a **${i(a.rateLimitPerUser*1e3)}**`:"disattivata"} in <#${a.channel.id}> con successo!`,components:[{type:u.ActionRow,components:[{type:u.Button,custom_id:`channel-s-${a.channel.id}-${a.rateLimitPerUser||t==null?0:t}`,label:a.rateLimitPerUser||t==null?"Rimuovi":"Annulla",style:f.Danger}]}]})},C=s({data:[{name:"channel",description:"Gestisci i canali",type:w.ChatInput,options:[{type:l.Subcommand,name:"slowmode",description:"Imposta o mostra la slowmode",options:[{name:"duration",description:"La nuova slowmode (0 per disattivarla, vuoto per mostrare quella attuale)",type:l.String},{name:"reason",description:"Il motivo della modifica della slowmode",type:l.String,max_length:512},{name:"channel",description:"Il canale da gestire (default: questo canale)",type:l.Channel}]}]}],async run(e){if(!e.inCachedGuild()){await e.reply({content:"Questo comando pu\xF2 essere usato solo all'interno di un server!",ephemeral:!0});return}let[{options:a}]=e.options.data;if(!a){await e.reply({content:"Questo comando non \xE8 attualmente disponibile!",ephemeral:!0});return}if(e.options.data[0].name==="slowmode"){if(a.some(o=>o.name==="duration")){if(await d(e))return;let o={channel:e.channel,rateLimitPerUser:0};for(let r of a)r.name==="channel"&&r.channel&&"client"in r.channel?o.channel=r.channel:r.name==="duration"?o.rateLimitPerUser=i(typeof r.value=="string"?r.value:"")||0:r.name==="reason"&&typeof r.value=="string"&&(o.reason=r.value);if(o.rateLimitPerUser=Math.round(o.rateLimitPerUser/1e3),await p(e,o))return;await h(e,o);return}let t=e.options.getChannel("channel"),n=t&&"setRateLimitPerUser"in t?t:e.channel;if(!n){await e.reply({content:"Canale non valido!",ephemeral:!0});return}await e.reply({content:n.rateLimitPerUser??0?`Slowmode attiva in <#${n.id}> ogni **${i(n.rateLimitPerUser*1e3)}**.`:`Slowmode non attiva in <#${n.id}>.`})}},async component(e){if(!e.inCachedGuild()){await e.reply({content:"Questo comando pu\xF2 essere usato solo all'interno di un server!",ephemeral:!0});return}let[,a,...t]=e.customId.split("-");if(!a||!["s"].includes(a)){await e.reply({content:"Azione non valida!",ephemeral:!0});return}if(a==="s"){if(await d(e))return;let n={channel:e.guild.channels.cache.get(t[0])??e.channel,rateLimitPerUser:Number(t[1])||0};if(await p(e,n))return;await h(e,n)}}});export{C as command};
//# sourceMappingURL=channel.js.map